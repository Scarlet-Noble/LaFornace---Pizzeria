<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recuperar Contrase√±a - La Fornace</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="styles/global.css">
    <link rel="stylesheet" href="styles/us03-recuperacion.css">
</head>

<body>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6">

                <div class="card mt-5 shadow-sm">
                    <div class="card-header text-center bg-dark text-white">
                        <h3 class="mb-0">üîë Recuperar Contrase√±a</h3>
                    </div>

                    <div class="card-body">

                        <!-- ============================ -->
                        <!-- PASO 1: Solicitar Enlace     -->
                        <!-- ============================ -->
                        <h5 class="fw-bold">Paso 1: Solicitar enlace</h5>

                        <form id="form-solicitar" class="mb-4">
                            <div class="mb-3">
                                <label class="form-label" for="email">Correo electr√≥nico</label>
                                <input type="email" id="email" class="form-control" required>
                            </div>

                            <button class="btn btn-primary w-100">Enviar enlace</button>
                        </form>

                        <hr>

                        <!-- ============================ -->
                        <!-- PASO 2: Restablecer Password -->
                        <!-- ============================ -->
                        <h5 class="fw-bold">Paso 2: Restablecer contrase√±a</h5>

                        <form id="form-restablecer">
                            <div class="mb-3">
                                <label class="form-label" for="token">Token recibido</label>
                                <input type="text" id="token" class="form-control" placeholder="ABC123XYZ">
                            </div>

                            <div class="mb-3">
                                <label class="form-label" for="new-password">Nueva contrase√±a</label>
                                <input type="password" id="new-password" class="form-control">
                            </div>

                            <button class="btn btn-success w-100">Restablecer</button>
                        </form>

                        <!-- MENSAJES -->
                        <div id="success-msg" class="alert alert-success mt-3 d-none">
                            ‚úì Contrase√±a actualizada correctamente.
                        </div>

                        <div id="error-token" class="alert alert-danger mt-3 d-none">
                            ‚úó Token inv√°lido o expirado.
                        </div>

                    </div>

                    <div class="card-footer text-center">
                        <a href="us02-login.html">Volver a Login</a> |
                        <a href="index.html" class="text-secondary">Inicio</a>
                    </div>

                </div>

            </div>
        </div>
    </div>

    <!-- API GLOBAL -->
    <script src="scripts/api.js"></script>

    <!-- L√ìGICA RECUPERACI√ìN -->
    <script>
    document.addEventListener("DOMContentLoaded", () => {

        const formSolicitar   = document.getElementById("form-solicitar");
        const formRestablecer = document.getElementById("form-restablecer");
        const successMsg      = document.getElementById("success-msg");
        const errorToken      = document.getElementById("error-token");

        // ======================================================
        // PASO 1: SIMULACI√ìN DE ENV√çO DE CORREO
        // ======================================================
        formSolicitar.addEventListener("submit", async (e) => {
            e.preventDefault();

            const email = document.getElementById("email").value.trim();

            alert("Si el correo existe, se enviar√° un enlace de recuperaci√≥n.\n(Simulado ‚Äî backend sin endpoint)");
        });

        // ======================================================
        // PASO 2: SIMULACI√ìN DE RESTABLECER CONTRASE√ëA
        // ======================================================
        formRestablecer.addEventListener("submit", async (e) => {
            e.preventDefault();

            const token       = document.getElementById("token").value.trim();
            const newPassword = document.getElementById("new-password").value.trim();

            if (!token || !newPassword) {
                alert("Debes ingresar token y nueva contrase√±a.");
                return;
            }

            if (newPassword.length < 8) {
                alert("La contrase√±a debe tener al menos 8 caracteres.");
                return;
            }

            // Simulaci√≥n
            if (token !== "123") {
                errorToken.classList.remove("d-none");
                successMsg.classList.add("d-none");
                return;
            }

            errorToken.classList.add("d-none");
            successMsg.classList.remove("d-none");

            setTimeout(() => {
                window.location.href = "us02-login.html";
            }, 1200);
        });
    });
    </script>

</body>
</html>
